import unittest

from ddt import ddt, data, unpack
import tripy


STAR = [(350, 75), (379, 161), (469, 161), (397, 215), (423, 301), (350, 250), (277, 301), (303, 215), (231, 161), (321, 161)]
STAR_TRIANGLES = [((321, 161), (350, 75), (379, 161)), ((379, 161), (469, 161), (397, 215)), ((397, 215), (423, 301), (350, 250)), ((350, 250), (277, 301), (303, 215)), ((303, 215), (231, 161), (321, 161)), ((321, 161), (379, 161), (397, 215)), ((321, 161), (397, 215), (350, 250)), ((321, 161), (350, 250), (303, 215))]
SIMPLE_DIAMOND = [(0,1), (-1, 0), (0, -1), (1, 0)]
SIMPLE_DIAMOND_TRIANGLES = [((1, 0), (0, 1), (-1, 0)), ((1, 0), (-1, 0), (0, -1))]
NO_CONCAVE_VERTEX = [(-2.0, -17.0), (-2.0, -8.0), (-8.0, -2.0), (-17.0, -2.0), (-20.0, -8.0), (-18.0, -17.0), (-12.0, -24.0), (-7.0, -22.0)]
NO_CONCAVE_VERTEX_TRIANGLES = [((-7.0, -22.0), (-2.0, -17.0), (-2.0, -8.0)), ((-7.0, -22.0), (-2.0, -8.0), (-8.0, -2.0)), ((-7.0, -22.0), (-8.0, -2.0), (-17.0, -2.0)), ((-7.0, -22.0), (-17.0, -2.0), (-20.0, -8.0)), ((-7.0, -22.0), (-20.0, -8.0), (-18.0, -17.0)), ((-7.0, -22.0), (-18.0, -17.0), (-12.0, -24.0))]
SLANTED_SIDE = [(-10.0, -20.0), (-10.0, -30.0), (0.0, -20.0), (0.0, -10.0), (-20.0, -10.0), (-20.0, -20.0)]
SLANTED_SIDE_TRIANGLES = [((-10.0, -20.0), (-10.0, -30.0), (0.0, -20.0)), ((-10.0, -20.0), (0.0, -20.0), (0.0, -10.0)), ((-10.0, -20.0), (0.0, -10.0), (-20.0, -10.0)), ((-10.0, -20.0), (-20.0, -10.0), (-20.0, -20.0))]
NEW_THANG = [(-20.0, -20.0), (-10.0, -20.0), (-10.0, -30.0), (0.0, -20.0), (10.0, -20.0), (0.0, -10.0), (10.0, 0.0), (0.0, 0.0), (-10.0, -10.0), (-10.0, 0.0), (-20.0, -10.0), (-30.0, -10.0)]
NEW_THANG_TRIANGLES = [((-30.0, -10.0), (-20.0, -20.0), (-10.0, -20.0)), ((-10.0, -20.0), (-10.0, -30.0), (0.0, -20.0)), ((0.0, -20.0), (10.0, -20.0), (0.0, -10.0)), ((0.0, -10.0), (10.0, 0.0), (0.0, 0.0)), ((0.0, -10.0), (0.0, 0.0), (-10.0, -10.0)), ((-10.0, -10.0), (-10.0, 0.0), (-20.0, -10.0)), ((-20.0, -10.0), (-30.0, -10.0), (-10.0, -20.0)), ((-20.0, -10.0), (-10.0, -20.0), (0.0, -20.0)), ((0.0, -20.0), (0.0, -10.0), (-10.0, -10.0)), ((-10.0, -10.0), (-20.0, -10.0), (0.0, -20.0))]


TEST_DATA = [
    (STAR, STAR_TRIANGLES),
    (SIMPLE_DIAMOND, SIMPLE_DIAMOND_TRIANGLES),
    (NO_CONCAVE_VERTEX, NO_CONCAVE_VERTEX_TRIANGLES),
    (SLANTED_SIDE, SLANTED_SIDE_TRIANGLES),
    (NEW_THANG, NEW_THANG_TRIANGLES)
]


@ddt
class TestPolygons(unittest.TestCase):

    @data(*TEST_DATA)
    @unpack
    def test_polygon(self, polygon, expected):
        actual = tripy.earclip(polygon)
        self.assertEqual(actual, expected)


if __name__ == '__main__':
    unittest.main()
